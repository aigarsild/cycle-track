"use strict";
/*
 * ATTENTION: An "eval-source-map" devtool has been used.
 * This devtool is neither made for production nor for readable output files.
 * It uses "eval()" calls to create a separate source file with attached SourceMaps in the browser devtools.
 * If you are trying to read the output file, select a different devtool (https://webpack.js.org/configuration/devtool/)
 * or disable the default devtool with "devtool: false".
 * If you are looking for production-ready output files, see mode: "production" (https://webpack.js.org/configuration/mode/).
 */
(() => {
var exports = {};
exports.id = "app/api/service-tickets/route";
exports.ids = ["app/api/service-tickets/route"];
exports.modules = {

/***/ "next/dist/compiled/next-server/app-page.runtime.dev.js":
/*!*************************************************************************!*\
  !*** external "next/dist/compiled/next-server/app-page.runtime.dev.js" ***!
  \*************************************************************************/
/***/ ((module) => {

module.exports = require("next/dist/compiled/next-server/app-page.runtime.dev.js");

/***/ }),

/***/ "next/dist/compiled/next-server/app-route.runtime.dev.js":
/*!**************************************************************************!*\
  !*** external "next/dist/compiled/next-server/app-route.runtime.dev.js" ***!
  \**************************************************************************/
/***/ ((module) => {

module.exports = require("next/dist/compiled/next-server/app-route.runtime.dev.js");

/***/ }),

/***/ "buffer":
/*!*************************!*\
  !*** external "buffer" ***!
  \*************************/
/***/ ((module) => {

module.exports = require("buffer");

/***/ }),

/***/ "crypto":
/*!*************************!*\
  !*** external "crypto" ***!
  \*************************/
/***/ ((module) => {

module.exports = require("crypto");

/***/ }),

/***/ "events":
/*!*************************!*\
  !*** external "events" ***!
  \*************************/
/***/ ((module) => {

module.exports = require("events");

/***/ }),

/***/ "http":
/*!***********************!*\
  !*** external "http" ***!
  \***********************/
/***/ ((module) => {

module.exports = require("http");

/***/ }),

/***/ "https":
/*!************************!*\
  !*** external "https" ***!
  \************************/
/***/ ((module) => {

module.exports = require("https");

/***/ }),

/***/ "net":
/*!**********************!*\
  !*** external "net" ***!
  \**********************/
/***/ ((module) => {

module.exports = require("net");

/***/ }),

/***/ "punycode":
/*!***************************!*\
  !*** external "punycode" ***!
  \***************************/
/***/ ((module) => {

module.exports = require("punycode");

/***/ }),

/***/ "stream":
/*!*************************!*\
  !*** external "stream" ***!
  \*************************/
/***/ ((module) => {

module.exports = require("stream");

/***/ }),

/***/ "tls":
/*!**********************!*\
  !*** external "tls" ***!
  \**********************/
/***/ ((module) => {

module.exports = require("tls");

/***/ }),

/***/ "url":
/*!**********************!*\
  !*** external "url" ***!
  \**********************/
/***/ ((module) => {

module.exports = require("url");

/***/ }),

/***/ "zlib":
/*!***********************!*\
  !*** external "zlib" ***!
  \***********************/
/***/ ((module) => {

module.exports = require("zlib");

/***/ }),

/***/ "(rsc)/./node_modules/next/dist/build/webpack/loaders/next-app-loader.js?name=app%2Fapi%2Fservice-tickets%2Froute&page=%2Fapi%2Fservice-tickets%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Fservice-tickets%2Froute.ts&appDir=%2FUsers%2Faigarsild%2Fcycle-track%2Fsrc%2Fapp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=%2FUsers%2Faigarsild%2Fcycle-track&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=&preferredRegion=&middlewareConfig=e30%3D!":
/*!***************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************!*\
  !*** ./node_modules/next/dist/build/webpack/loaders/next-app-loader.js?name=app%2Fapi%2Fservice-tickets%2Froute&page=%2Fapi%2Fservice-tickets%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Fservice-tickets%2Froute.ts&appDir=%2FUsers%2Faigarsild%2Fcycle-track%2Fsrc%2Fapp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=%2FUsers%2Faigarsild%2Fcycle-track&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=&preferredRegion=&middlewareConfig=e30%3D! ***!
  \***************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   originalPathname: () => (/* binding */ originalPathname),\n/* harmony export */   patchFetch: () => (/* binding */ patchFetch),\n/* harmony export */   requestAsyncStorage: () => (/* binding */ requestAsyncStorage),\n/* harmony export */   routeModule: () => (/* binding */ routeModule),\n/* harmony export */   serverHooks: () => (/* binding */ serverHooks),\n/* harmony export */   staticGenerationAsyncStorage: () => (/* binding */ staticGenerationAsyncStorage)\n/* harmony export */ });\n/* harmony import */ var next_dist_server_future_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! next/dist/server/future/route-modules/app-route/module.compiled */ \"(rsc)/./node_modules/next/dist/server/future/route-modules/app-route/module.compiled.js\");\n/* harmony import */ var next_dist_server_future_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(next_dist_server_future_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var next_dist_server_future_route_kind__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! next/dist/server/future/route-kind */ \"(rsc)/./node_modules/next/dist/server/future/route-kind.js\");\n/* harmony import */ var next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! next/dist/server/lib/patch-fetch */ \"(rsc)/./node_modules/next/dist/server/lib/patch-fetch.js\");\n/* harmony import */ var next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2___default = /*#__PURE__*/__webpack_require__.n(next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2__);\n/* harmony import */ var _Users_aigarsild_cycle_track_src_app_api_service_tickets_route_ts__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./src/app/api/service-tickets/route.ts */ \"(rsc)/./src/app/api/service-tickets/route.ts\");\n\n\n\n\n// We inject the nextConfigOutput here so that we can use them in the route\n// module.\nconst nextConfigOutput = \"\"\nconst routeModule = new next_dist_server_future_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0__.AppRouteRouteModule({\n    definition: {\n        kind: next_dist_server_future_route_kind__WEBPACK_IMPORTED_MODULE_1__.RouteKind.APP_ROUTE,\n        page: \"/api/service-tickets/route\",\n        pathname: \"/api/service-tickets\",\n        filename: \"route\",\n        bundlePath: \"app/api/service-tickets/route\"\n    },\n    resolvedPagePath: \"/Users/aigarsild/cycle-track/src/app/api/service-tickets/route.ts\",\n    nextConfigOutput,\n    userland: _Users_aigarsild_cycle_track_src_app_api_service_tickets_route_ts__WEBPACK_IMPORTED_MODULE_3__\n});\n// Pull out the exports that we need to expose from the module. This should\n// be eliminated when we've moved the other routes to the new format. These\n// are used to hook into the route.\nconst { requestAsyncStorage, staticGenerationAsyncStorage, serverHooks } = routeModule;\nconst originalPathname = \"/api/service-tickets/route\";\nfunction patchFetch() {\n    return (0,next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2__.patchFetch)({\n        serverHooks,\n        staticGenerationAsyncStorage\n    });\n}\n\n\n//# sourceMappingURL=app-route.js.map//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9ub2RlX21vZHVsZXMvbmV4dC9kaXN0L2J1aWxkL3dlYnBhY2svbG9hZGVycy9uZXh0LWFwcC1sb2FkZXIuanM/bmFtZT1hcHAlMkZhcGklMkZzZXJ2aWNlLXRpY2tldHMlMkZyb3V0ZSZwYWdlPSUyRmFwaSUyRnNlcnZpY2UtdGlja2V0cyUyRnJvdXRlJmFwcFBhdGhzPSZwYWdlUGF0aD1wcml2YXRlLW5leHQtYXBwLWRpciUyRmFwaSUyRnNlcnZpY2UtdGlja2V0cyUyRnJvdXRlLnRzJmFwcERpcj0lMkZVc2VycyUyRmFpZ2Fyc2lsZCUyRmN5Y2xlLXRyYWNrJTJGc3JjJTJGYXBwJnBhZ2VFeHRlbnNpb25zPXRzeCZwYWdlRXh0ZW5zaW9ucz10cyZwYWdlRXh0ZW5zaW9ucz1qc3gmcGFnZUV4dGVuc2lvbnM9anMmcm9vdERpcj0lMkZVc2VycyUyRmFpZ2Fyc2lsZCUyRmN5Y2xlLXRyYWNrJmlzRGV2PXRydWUmdHNjb25maWdQYXRoPXRzY29uZmlnLmpzb24mYmFzZVBhdGg9JmFzc2V0UHJlZml4PSZuZXh0Q29uZmlnT3V0cHV0PSZwcmVmZXJyZWRSZWdpb249Jm1pZGRsZXdhcmVDb25maWc9ZTMwJTNEISIsIm1hcHBpbmdzIjoiOzs7Ozs7Ozs7Ozs7Ozs7QUFBc0c7QUFDdkM7QUFDYztBQUNpQjtBQUM5RjtBQUNBO0FBQ0E7QUFDQSx3QkFBd0IsZ0hBQW1CO0FBQzNDO0FBQ0EsY0FBYyx5RUFBUztBQUN2QjtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0EsWUFBWTtBQUNaLENBQUM7QUFDRDtBQUNBO0FBQ0E7QUFDQSxRQUFRLGlFQUFpRTtBQUN6RTtBQUNBO0FBQ0EsV0FBVyw0RUFBVztBQUN0QjtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ3VIOztBQUV2SCIsInNvdXJjZXMiOlsid2VicGFjazovL2Jpa2Utc2hvcC1zZXJ2aWNlLW1hbmFnZW1lbnQvPzA3MzkiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgQXBwUm91dGVSb3V0ZU1vZHVsZSB9IGZyb20gXCJuZXh0L2Rpc3Qvc2VydmVyL2Z1dHVyZS9yb3V0ZS1tb2R1bGVzL2FwcC1yb3V0ZS9tb2R1bGUuY29tcGlsZWRcIjtcbmltcG9ydCB7IFJvdXRlS2luZCB9IGZyb20gXCJuZXh0L2Rpc3Qvc2VydmVyL2Z1dHVyZS9yb3V0ZS1raW5kXCI7XG5pbXBvcnQgeyBwYXRjaEZldGNoIGFzIF9wYXRjaEZldGNoIH0gZnJvbSBcIm5leHQvZGlzdC9zZXJ2ZXIvbGliL3BhdGNoLWZldGNoXCI7XG5pbXBvcnQgKiBhcyB1c2VybGFuZCBmcm9tIFwiL1VzZXJzL2FpZ2Fyc2lsZC9jeWNsZS10cmFjay9zcmMvYXBwL2FwaS9zZXJ2aWNlLXRpY2tldHMvcm91dGUudHNcIjtcbi8vIFdlIGluamVjdCB0aGUgbmV4dENvbmZpZ091dHB1dCBoZXJlIHNvIHRoYXQgd2UgY2FuIHVzZSB0aGVtIGluIHRoZSByb3V0ZVxuLy8gbW9kdWxlLlxuY29uc3QgbmV4dENvbmZpZ091dHB1dCA9IFwiXCJcbmNvbnN0IHJvdXRlTW9kdWxlID0gbmV3IEFwcFJvdXRlUm91dGVNb2R1bGUoe1xuICAgIGRlZmluaXRpb246IHtcbiAgICAgICAga2luZDogUm91dGVLaW5kLkFQUF9ST1VURSxcbiAgICAgICAgcGFnZTogXCIvYXBpL3NlcnZpY2UtdGlja2V0cy9yb3V0ZVwiLFxuICAgICAgICBwYXRobmFtZTogXCIvYXBpL3NlcnZpY2UtdGlja2V0c1wiLFxuICAgICAgICBmaWxlbmFtZTogXCJyb3V0ZVwiLFxuICAgICAgICBidW5kbGVQYXRoOiBcImFwcC9hcGkvc2VydmljZS10aWNrZXRzL3JvdXRlXCJcbiAgICB9LFxuICAgIHJlc29sdmVkUGFnZVBhdGg6IFwiL1VzZXJzL2FpZ2Fyc2lsZC9jeWNsZS10cmFjay9zcmMvYXBwL2FwaS9zZXJ2aWNlLXRpY2tldHMvcm91dGUudHNcIixcbiAgICBuZXh0Q29uZmlnT3V0cHV0LFxuICAgIHVzZXJsYW5kXG59KTtcbi8vIFB1bGwgb3V0IHRoZSBleHBvcnRzIHRoYXQgd2UgbmVlZCB0byBleHBvc2UgZnJvbSB0aGUgbW9kdWxlLiBUaGlzIHNob3VsZFxuLy8gYmUgZWxpbWluYXRlZCB3aGVuIHdlJ3ZlIG1vdmVkIHRoZSBvdGhlciByb3V0ZXMgdG8gdGhlIG5ldyBmb3JtYXQuIFRoZXNlXG4vLyBhcmUgdXNlZCB0byBob29rIGludG8gdGhlIHJvdXRlLlxuY29uc3QgeyByZXF1ZXN0QXN5bmNTdG9yYWdlLCBzdGF0aWNHZW5lcmF0aW9uQXN5bmNTdG9yYWdlLCBzZXJ2ZXJIb29rcyB9ID0gcm91dGVNb2R1bGU7XG5jb25zdCBvcmlnaW5hbFBhdGhuYW1lID0gXCIvYXBpL3NlcnZpY2UtdGlja2V0cy9yb3V0ZVwiO1xuZnVuY3Rpb24gcGF0Y2hGZXRjaCgpIHtcbiAgICByZXR1cm4gX3BhdGNoRmV0Y2goe1xuICAgICAgICBzZXJ2ZXJIb29rcyxcbiAgICAgICAgc3RhdGljR2VuZXJhdGlvbkFzeW5jU3RvcmFnZVxuICAgIH0pO1xufVxuZXhwb3J0IHsgcm91dGVNb2R1bGUsIHJlcXVlc3RBc3luY1N0b3JhZ2UsIHN0YXRpY0dlbmVyYXRpb25Bc3luY1N0b3JhZ2UsIHNlcnZlckhvb2tzLCBvcmlnaW5hbFBhdGhuYW1lLCBwYXRjaEZldGNoLCAgfTtcblxuLy8jIHNvdXJjZU1hcHBpbmdVUkw9YXBwLXJvdXRlLmpzLm1hcCJdLCJuYW1lcyI6W10sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(rsc)/./node_modules/next/dist/build/webpack/loaders/next-app-loader.js?name=app%2Fapi%2Fservice-tickets%2Froute&page=%2Fapi%2Fservice-tickets%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Fservice-tickets%2Froute.ts&appDir=%2FUsers%2Faigarsild%2Fcycle-track%2Fsrc%2Fapp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=%2FUsers%2Faigarsild%2Fcycle-track&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=&preferredRegion=&middlewareConfig=e30%3D!\n");

/***/ }),

/***/ "(rsc)/./src/app/api/service-tickets/route.ts":
/*!**********************************************!*\
  !*** ./src/app/api/service-tickets/route.ts ***!
  \**********************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   GET: () => (/* binding */ GET),\n/* harmony export */   PATCH: () => (/* binding */ PATCH),\n/* harmony export */   POST: () => (/* binding */ POST)\n/* harmony export */ });\n/* harmony import */ var _lib_supabase__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @/lib/supabase */ \"(rsc)/./src/lib/supabase.ts\");\n/* harmony import */ var next_server__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! next/server */ \"(rsc)/./node_modules/next/dist/api/server.js\");\n\n\n// Fallback data for development if database isn't accessible\nconst mockServiceTickets = [\n    {\n        id: \"1\",\n        customerId: \"1\",\n        customer: {\n            id: \"1\",\n            name: \"John Smith\",\n            email: \"john@example.com\",\n            phone: \"123-456-7890\",\n            marketingConsent: true,\n            createdAt: \"2023-01-15T10:00:00Z\"\n        },\n        equipmentBrand: \"Trek\",\n        serviceType: \"Full Service\",\n        recipient: \"Self\",\n        additionalDetails: \"Bike is making a clicking noise when pedaling\",\n        status: \"todo\",\n        createdAt: \"2023-05-01T10:30:00Z\",\n        updatedAt: \"2023-05-01T10:30:00Z\",\n        comments: [\n            \"Initial inspection shows possible issue with bottom bracket\"\n        ]\n    },\n    {\n        id: \"2\",\n        customerId: \"2\",\n        customer: {\n            id: \"2\",\n            name: \"Jane Doe\",\n            email: \"jane@example.com\",\n            phone: \"234-567-8901\",\n            marketingConsent: false,\n            createdAt: \"2023-02-10T14:30:00Z\"\n        },\n        equipmentBrand: \"Specialized\",\n        serviceType: \"Simple Service\",\n        recipient: \"Gift\",\n        additionalDetails: \"Brakes need adjustment, gears slipping\",\n        status: \"in-progress\",\n        createdAt: \"2023-05-02T14:00:00Z\",\n        updatedAt: \"2023-05-03T09:15:00Z\",\n        mechanicId: \"M1\",\n        comments: [\n            \"Brake pads replaced on front and rear\",\n            \"Derailleur adjustment still needed\"\n        ]\n    },\n    {\n        id: \"3\",\n        customerId: \"3\",\n        customer: {\n            id: \"3\",\n            name: \"Michael Johnson\",\n            email: \"michael@example.com\",\n            phone: \"345-678-9012\",\n            marketingConsent: true,\n            createdAt: \"2023-03-05T09:15:00Z\"\n        },\n        equipmentBrand: \"Giant\",\n        serviceType: \"Other\",\n        recipient: \"Self\",\n        additionalDetails: \"Wheel truing and new tires installation\",\n        status: \"waiting-for-parts\",\n        createdAt: \"2023-05-04T11:30:00Z\",\n        updatedAt: \"2023-05-05T13:45:00Z\",\n        partsUsed: [\n            {\n                id: \"1\",\n                name: \"Bike Chain\",\n                category: \"Parts\",\n                barcode: \"BC-12345\",\n                price: 25.99,\n                description: \"High-quality bike chain\",\n                createdAt: \"2023-01-01T00:00:00Z\"\n            }\n        ],\n        comments: [\n            \"Waiting for Schwalbe Marathon tires to arrive\"\n        ]\n    },\n    {\n        id: \"4\",\n        customerId: \"1\",\n        customer: {\n            id: \"1\",\n            name: \"John Smith\",\n            email: \"john@example.com\",\n            phone: \"123-456-7890\",\n            marketingConsent: true,\n            createdAt: \"2023-01-15T10:00:00Z\"\n        },\n        equipmentBrand: \"Cannondale\",\n        serviceType: \"Full Service\",\n        recipient: \"Self\",\n        additionalDetails: \"Annual maintenance\",\n        status: \"done\",\n        createdAt: \"2023-04-15T09:00:00Z\",\n        updatedAt: \"2023-04-18T16:30:00Z\",\n        completionDate: \"2023-04-18T16:30:00Z\",\n        totalCost: 120.50,\n        mechanicId: \"M2\",\n        partsUsed: [\n            {\n                id: \"1\",\n                name: \"Bike Chain\",\n                category: \"Parts\",\n                barcode: \"BC-12345\",\n                price: 25.99,\n                description: \"High-quality bike chain\",\n                createdAt: \"2023-01-01T00:00:00Z\"\n            }\n        ],\n        comments: [\n            \"Complete service performed\",\n            \"New chain installed\",\n            \"All bearings cleaned and regreased\",\n            \"Ready for pickup\"\n        ]\n    },\n    {\n        id: \"5\",\n        customerId: \"2\",\n        customer: {\n            id: \"2\",\n            name: \"Jane Doe\",\n            email: \"jane@example.com\",\n            phone: \"234-567-8901\",\n            marketingConsent: false,\n            createdAt: \"2023-02-10T14:30:00Z\"\n        },\n        equipmentBrand: \"Cervelo\",\n        serviceType: \"Simple Service\",\n        recipient: \"Self\",\n        additionalDetails: \"Derailleur adjustment\",\n        status: \"todo\",\n        createdAt: \"2023-05-06T13:15:00Z\",\n        updatedAt: \"2023-05-06T13:15:00Z\",\n        comments: []\n    }\n];\nasync function GET(request) {\n    try {\n        const searchParams = request.nextUrl.searchParams;\n        const status = searchParams.get(\"status\");\n        // Ensure the database schema exists\n        await (0,_lib_supabase__WEBPACK_IMPORTED_MODULE_0__.ensureDatabaseSchema)();\n        // Try to fetch from Supabase\n        try {\n            console.log(\"Attempting to fetch data from Supabase...\");\n            const query = _lib_supabase__WEBPACK_IMPORTED_MODULE_0__.supabase.from(\"service_tickets\").select(`\n          *,\n          service_request:service_request_id(*,\n            customer:customer_id(*)\n          )\n        `);\n            if (status) {\n                query.eq(\"status\", status);\n            }\n            const { data, error } = await query.order(\"created_at\", {\n                ascending: false\n            });\n            if (error) {\n                console.error(\"Supabase query error:\", error);\n            }\n            console.log(\"Raw data received:\", data ? `${data.length} tickets` : \"No data\");\n            if (data && data.length > 0) {\n                console.log(\"First ticket raw data:\", JSON.stringify(data[0], null, 2));\n            }\n            if (!error && data && data.length > 0) {\n                // Transform the data to match our frontend types\n                const transformedData = data.map((ticket)=>{\n                    // Extract customer data or create fallbacks\n                    let customerData = {\n                        id: \"unknown\",\n                        name: \"Unknown Customer\",\n                        email: \"no-email@example.com\",\n                        phone: \"No phone number\",\n                        marketingConsent: false,\n                        createdAt: ticket.created_at\n                    };\n                    // Try to get customer from the nested object\n                    if (ticket.service_request?.customer) {\n                        customerData = {\n                            id: ticket.service_request.customer.id || customerData.id,\n                            name: ticket.service_request.customer.name || customerData.name,\n                            email: ticket.service_request.customer.email || customerData.email,\n                            phone: ticket.service_request.customer.phone || customerData.phone,\n                            marketingConsent: ticket.service_request.customer.marketing_consent || customerData.marketingConsent,\n                            createdAt: ticket.service_request.customer.created_at || customerData.createdAt\n                        };\n                    }\n                    return {\n                        id: ticket.id,\n                        customerId: ticket.service_request?.customer_id || \"unknown\",\n                        equipmentBrand: ticket.service_request?.equipment_brand || \"Unknown\",\n                        serviceType: ticket.service_request?.service_type || \"Other\",\n                        recipient: ticket.service_request?.recipient || \"Self\",\n                        additionalDetails: ticket.service_request?.additional_details || \"\",\n                        status: ticket.status,\n                        createdAt: ticket.created_at,\n                        updatedAt: ticket.updated_at,\n                        customer: customerData,\n                        partsUsed: ticket.parts_used || [],\n                        mechanicId: ticket.mechanic_id,\n                        completionDate: ticket.completion_date,\n                        totalCost: ticket.total_cost,\n                        comments: ticket.comments || []\n                    };\n                });\n                console.log(\"Transformed first ticket:\", JSON.stringify(transformedData[0], null, 2));\n                return next_server__WEBPACK_IMPORTED_MODULE_1__.NextResponse.json({\n                    tickets: transformedData\n                });\n            }\n        } catch (dbError) {\n            console.error(\"Database error, falling back to mock data:\", dbError);\n        }\n        // If we got here, either there was a database error or no results, use mock data\n        const filteredTickets = status ? mockServiceTickets.filter((ticket)=>ticket.status === status) : mockServiceTickets;\n        return next_server__WEBPACK_IMPORTED_MODULE_1__.NextResponse.json({\n            tickets: filteredTickets\n        });\n    } catch (error) {\n        console.error(\"Error in service-tickets API:\", error);\n        return next_server__WEBPACK_IMPORTED_MODULE_1__.NextResponse.json({\n            tickets: mockServiceTickets\n        }, {\n            status: 200\n        });\n    }\n}\nasync function POST(request) {\n    try {\n        const body = await request.json();\n        const { serviceRequest, customer } = body;\n        // First check if customer exists\n        let customerId = null;\n        const { data: existingCustomer } = await _lib_supabase__WEBPACK_IMPORTED_MODULE_0__.supabase.from(\"customers\").select(\"id\").eq(\"email\", customer.email).single();\n        if (existingCustomer) {\n            customerId = existingCustomer.id;\n            // Update customer if it exists\n            await _lib_supabase__WEBPACK_IMPORTED_MODULE_0__.supabase.from(\"customers\").update({\n                name: customer.name,\n                phone: customer.phone,\n                marketing_consent: customer.marketingConsent\n            }).eq(\"id\", customerId);\n        } else {\n            // Create new customer\n            const { data: newCustomer, error: customerError } = await _lib_supabase__WEBPACK_IMPORTED_MODULE_0__.supabase.from(\"customers\").insert({\n                name: customer.name,\n                email: customer.email,\n                phone: customer.phone,\n                marketing_consent: customer.marketingConsent\n            }).select().single();\n            if (customerError) {\n                return next_server__WEBPACK_IMPORTED_MODULE_1__.NextResponse.json({\n                    error: \"Error creating customer\",\n                    details: customerError.message\n                }, {\n                    status: 500\n                });\n            }\n            customerId = newCustomer.id;\n        }\n        // Create service request\n        const { data: serviceRequestData, error: serviceRequestError } = await _lib_supabase__WEBPACK_IMPORTED_MODULE_0__.supabase.from(\"service_requests\").insert({\n            customer_id: customerId,\n            equipment_brand: serviceRequest.equipmentBrand,\n            service_type: serviceRequest.serviceType,\n            recipient: serviceRequest.recipient,\n            additional_details: serviceRequest.additionalDetails\n        }).select().single();\n        if (serviceRequestError) {\n            return next_server__WEBPACK_IMPORTED_MODULE_1__.NextResponse.json({\n                error: \"Error creating service request\",\n                details: serviceRequestError.message\n            }, {\n                status: 500\n            });\n        }\n        // Create service ticket\n        const { data: ticketData, error: ticketError } = await _lib_supabase__WEBPACK_IMPORTED_MODULE_0__.supabase.from(\"service_tickets\").insert({\n            service_request_id: serviceRequestData.id,\n            status: \"todo\",\n            comments: []\n        }).select().single();\n        if (ticketError) {\n            return next_server__WEBPACK_IMPORTED_MODULE_1__.NextResponse.json({\n                error: \"Error creating service ticket\",\n                details: ticketError.message\n            }, {\n                status: 500\n            });\n        }\n        return next_server__WEBPACK_IMPORTED_MODULE_1__.NextResponse.json({\n            ticket: ticketData,\n            serviceRequest: serviceRequestData,\n            customer: {\n                id: customerId,\n                name: customer.name,\n                email: customer.email,\n                phone: customer.phone,\n                marketingConsent: customer.marketingConsent\n            }\n        }, {\n            status: 201\n        });\n    } catch (error) {\n        return next_server__WEBPACK_IMPORTED_MODULE_1__.NextResponse.json({\n            error: \"Internal Server Error\",\n            details: error?.message\n        }, {\n            status: 500\n        });\n    }\n}\nasync function PATCH(request) {\n    try {\n        const body = await request.json();\n        const { id, status, partsUsed, mechanicId, totalCost, comments } = body;\n        if (!id) {\n            return next_server__WEBPACK_IMPORTED_MODULE_1__.NextResponse.json({\n                error: \"Ticket ID is required\"\n            }, {\n                status: 400\n            });\n        }\n        const updates = {};\n        if (status) updates.status = status;\n        if (partsUsed) updates.parts_used = partsUsed;\n        if (mechanicId) updates.mechanic_id = mechanicId;\n        if (totalCost) updates.total_cost = totalCost;\n        if (comments) updates.comments = comments;\n        // If status is 'done', set completion date\n        if (status === \"done\") {\n            updates.completion_date = new Date().toISOString();\n        }\n        try {\n            // Try to update in Supabase\n            const { data, error } = await _lib_supabase__WEBPACK_IMPORTED_MODULE_0__.supabase.from(\"service_tickets\").update(updates).eq(\"id\", id).select().single();\n            if (!error) {\n                return next_server__WEBPACK_IMPORTED_MODULE_1__.NextResponse.json({\n                    ticket: data\n                });\n            }\n        } catch (dbError) {\n            console.error(\"Database update error, using client-side only:\", dbError);\n        }\n        // If database update failed, use mock data for demonstration\n        if (comments) {\n            // Find and update the ticket in our mock data\n            const ticketIndex = mockServiceTickets.findIndex((t)=>t.id === id);\n            if (ticketIndex !== -1) {\n                // We've verified the index exists, so the ticket definitely exists at this point\n                const ticket = mockServiceTickets[ticketIndex];\n                // Initialize comments if needed\n                if (!ticket.comments) {\n                    ticket.comments = [];\n                }\n                // Update comments\n                ticket.comments = comments;\n                return next_server__WEBPACK_IMPORTED_MODULE_1__.NextResponse.json({\n                    success: true,\n                    ticket\n                });\n            }\n        }\n        // Generic success response for other updates\n        return next_server__WEBPACK_IMPORTED_MODULE_1__.NextResponse.json({\n            success: true,\n            message: \"Status updated in UI only. Database update not available.\"\n        });\n    } catch (error) {\n        console.error(\"Error in PATCH:\", error);\n        return next_server__WEBPACK_IMPORTED_MODULE_1__.NextResponse.json({\n            error: \"Internal Server Error\",\n            details: error?.message\n        }, {\n            status: 500\n        });\n    }\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9zcmMvYXBwL2FwaS9zZXJ2aWNlLXRpY2tldHMvcm91dGUudHMiLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7QUFBZ0U7QUFDUjtBQUd4RCw2REFBNkQ7QUFDN0QsTUFBTUcscUJBQXNDO0lBQzFDO1FBQ0VDLElBQUk7UUFDSkMsWUFBWTtRQUNaQyxVQUFVO1lBQ1JGLElBQUk7WUFDSkcsTUFBTTtZQUNOQyxPQUFPO1lBQ1BDLE9BQU87WUFDUEMsa0JBQWtCO1lBQ2xCQyxXQUFXO1FBQ2I7UUFDQUMsZ0JBQWdCO1FBQ2hCQyxhQUFhO1FBQ2JDLFdBQVc7UUFDWEMsbUJBQW1CO1FBQ25CQyxRQUFRO1FBQ1JMLFdBQVc7UUFDWE0sV0FBVztRQUNYQyxVQUFVO1lBQUM7U0FBOEQ7SUFDM0U7SUFDQTtRQUNFZCxJQUFJO1FBQ0pDLFlBQVk7UUFDWkMsVUFBVTtZQUNSRixJQUFJO1lBQ0pHLE1BQU07WUFDTkMsT0FBTztZQUNQQyxPQUFPO1lBQ1BDLGtCQUFrQjtZQUNsQkMsV0FBVztRQUNiO1FBQ0FDLGdCQUFnQjtRQUNoQkMsYUFBYTtRQUNiQyxXQUFXO1FBQ1hDLG1CQUFtQjtRQUNuQkMsUUFBUTtRQUNSTCxXQUFXO1FBQ1hNLFdBQVc7UUFDWEUsWUFBWTtRQUNaRCxVQUFVO1lBQUM7WUFBeUM7U0FBcUM7SUFDM0Y7SUFDQTtRQUNFZCxJQUFJO1FBQ0pDLFlBQVk7UUFDWkMsVUFBVTtZQUNSRixJQUFJO1lBQ0pHLE1BQU07WUFDTkMsT0FBTztZQUNQQyxPQUFPO1lBQ1BDLGtCQUFrQjtZQUNsQkMsV0FBVztRQUNiO1FBQ0FDLGdCQUFnQjtRQUNoQkMsYUFBYTtRQUNiQyxXQUFXO1FBQ1hDLG1CQUFtQjtRQUNuQkMsUUFBUTtRQUNSTCxXQUFXO1FBQ1hNLFdBQVc7UUFDWEcsV0FBVztZQUFDO2dCQUNWaEIsSUFBSTtnQkFDSkcsTUFBTTtnQkFDTmMsVUFBVTtnQkFDVkMsU0FBUztnQkFDVEMsT0FBTztnQkFDUEMsYUFBYTtnQkFDYmIsV0FBVztZQUNiO1NBQUU7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LFNBQVM7b0JBQ1QxQztnQkFDRjtZQUNGO1FBQ0Y7UUFFQSw2Q0FBNkM7UUFDN0MsT0FBTzdDLHFEQUFZQSxDQUFDMkQsSUFBSSxDQUFDO1lBQ3ZCNEIsU0FBUztZQUNUYixTQUFTO1FBQ1g7SUFFRixFQUFFLE9BQU9yQyxPQUFZO1FBQ25CUCxRQUFRTyxLQUFLLENBQUMsbUJBQW1CQTtRQUNqQyxPQUFPckMscURBQVlBLENBQUMyRCxJQUFJLENBQ3RCO1lBQUV0QixPQUFPO1lBQXlCb0MsU0FBU3BDLE9BQU9xQztRQUFRLEdBQzFEO1lBQUU1RCxRQUFRO1FBQUk7SUFFbEI7QUFDRiIsInNvdXJjZXMiOlsid2VicGFjazovL2Jpa2Utc2hvcC1zZXJ2aWNlLW1hbmFnZW1lbnQvLi9zcmMvYXBwL2FwaS9zZXJ2aWNlLXRpY2tldHMvcm91dGUudHM/ZmM4ZiJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBzdXBhYmFzZSwgZW5zdXJlRGF0YWJhc2VTY2hlbWEgfSBmcm9tICdAL2xpYi9zdXBhYmFzZSc7XG5pbXBvcnQgeyBOZXh0UmVxdWVzdCwgTmV4dFJlc3BvbnNlIH0gZnJvbSAnbmV4dC9zZXJ2ZXInO1xuaW1wb3J0IHR5cGUgeyBTZXJ2aWNlVGlja2V0IH0gZnJvbSAnQC90eXBlcyc7XG5cbi8vIEZhbGxiYWNrIGRhdGEgZm9yIGRldmVsb3BtZW50IGlmIGRhdGFiYXNlIGlzbid0IGFjY2Vzc2libGVcbmNvbnN0IG1vY2tTZXJ2aWNlVGlja2V0czogU2VydmljZVRpY2tldFtdID0gW1xuICB7XG4gICAgaWQ6ICcxJyxcbiAgICBjdXN0b21lcklkOiAnMScsXG4gICAgY3VzdG9tZXI6IHtcbiAgICAgIGlkOiAnMScsXG4gICAgICBuYW1lOiAnSm9obiBTbWl0aCcsXG4gICAgICBlbWFpbDogJ2pvaG5AZXhhbXBsZS5jb20nLFxuICAgICAgcGhvbmU6ICcxMjMtNDU2LTc4OTAnLFxuICAgICAgbWFya2V0aW5nQ29uc2VudDogdHJ1ZSxcbiAgICAgIGNyZWF0ZWRBdDogJzIwMjMtMDEtMTVUMTA6MDA6MDBaJ1xuICAgIH0sXG4gICAgZXF1aXBtZW50QnJhbmQ6ICdUcmVrJyxcbiAgICBzZXJ2aWNlVHlwZTogJ0Z1bGwgU2VydmljZScsXG4gICAgcmVjaXBpZW50OiAnU2VsZicsXG4gICAgYWRkaXRpb25hbERldGFpbHM6ICdCaWtlIGlzIG1ha2luZyBhIGNsaWNraW5nIG5vaXNlIHdoZW4gcGVkYWxpbmcnLFxuICAgIHN0YXR1czogJ3RvZG8nLFxuICAgIGNyZWF0ZWRBdDogJzIwMjMtMDUtMDFUMTA6MzA6MDBaJyxcbiAgICB1cGRhdGVkQXQ6ICcyMDIzLTA1LTAxVDEwOjMwOjAwWicsXG4gICAgY29tbWVudHM6IFsnSW5pdGlhbCBpbnNwZWN0aW9uIHNob3dzIHBvc3NpYmxlIGlzc3VlIHdpdGggYm90dG9tIGJyYWNrZXQnXVxuICB9LFxuICB7XG4gICAgaWQ6ICcyJyxcbiAgICBjdXN0b21lcklkOiAnMicsXG4gICAgY3VzdG9tZXI6IHtcbiAgICAgIGlkOiAnMicsXG4gICAgICBuYW1lOiAnSmFuZSBEb2UnLFxuICAgICAgZW1haWw6ICdqYW5lQGV4YW1wbGUuY29tJyxcbiAgICAgIHBob25lOiAnMjM0LTU2Ny04OTAxJyxcbiAgICAgIG1hcmtldGluZ0NvbnNlbnQ6IGZhbHNlLFxuICAgICAgY3JlYXRlZEF0OiAnMjAyMy0wMi0xMFQxNDozMDowMFonXG4gICAgfSxcbiAgICBlcXVpcG1lbnRCcmFuZDogJ1NwZWNpYWxpemVkJyxcbiAgICBzZXJ2aWNlVHlwZTogJ1NpbXBsZSBTZXJ2aWNlJyxcbiAgICByZWNpcGllbnQ6ICdHaWZ0JyxcbiAgICBhZGRpdGlvbmFsRGV0YWlsczogJ0JyYWtlcyBuZWVkIGFkanVzdG1lbnQsIGdlYXJzIHNsaXBwaW5nJyxcbiAgICBzdGF0dXM6ICdpbi1wcm9ncmVzcycsXG4gICAgY3JlYXRlZEF0OiAnMjAyMy0wNS0wMlQxNDowMDowMFonLFxuICAgIHVwZGF0ZWRBdDogJzIwMjMtMDUtMDNUMDk6MTU6MDBaJyxcbiAgICBtZWNoYW5pY0lkOiAnTTEnLFxuICAgIGNvbW1lbnRzOiBbJ0JyYWtlIHBhZHMgcmVwbGFjZWQgb24gZnJvbnQgYW5kIHJlYXInLCAnRGVyYWlsbGV1ciBhZGp1c3RtZW50IHN0aWxsIG5lZWRlZCddXG4gIH0sXG4gIHtcbiAgICBpZDogJzMnLFxuICAgIGN1c3RvbWVySWQ6ICczJyxcbiAgICBjdXN0b21lcjoge1xuICAgICAgaWQ6ICczJyxcbiAgICAgIG5hbWU6ICdNaWNoYWVsIEpvaG5zb24nLFxuICAgICAgZW1haWw6ICdtaWNoYWVsQGV4YW1wbGUuY29tJyxcbiAgICAgIHBob25lOiAnMzQ1LTY3OC05MDEyJyxcbiAgICAgIG1hcmtldGluZ0NvbnNlbnQ6IHRydWUsXG4gICAgICBjcmVhdGVkQXQ6ICcyMDIzLTAzLTA1VDA5OjE1OjAwWidcbiAgICB9LFxuICAgIGVxdWlwbWVudEJyYW5kOiAnR2lhbnQnLFxuICAgIHNlcnZpY2VUeXBlOiAnT3RoZXInLFxuICAgIHJlY2lwaWVudDogJ1NlbGYnLFxuICAgIGFkZGl0aW9uYWxEZXRhaWxzOiAnV2hlZWwgdHJ1aW5nIGFuZCBuZXcgdGlyZXMgaW5zdGFsbGF0aW9uJyxcbiAgICBzdGF0dXM6ICd3YWl0aW5nLWZvci1wYXJ0cycsXG4gICAgY3JlYXRlZEF0OiAnMjAyMy0wNS0wNFQxMTozMDowMFonLFxuICAgIHVwZGF0ZWRBdDogJzIwMjMtMDUtMDVUMTM6NDU6MDBaJyxcbiAgICBwYXJ0c1VzZWQ6IFt7XG4gICAgICBpZDogJzEnLFxuICAgICAgbmFtZTogJ0Jpa2UgQ2hhaW4nLFxuICAgICAgY2F0ZWdvcnk6ICdQYXJ0cycsXG4gICAgICBiYXJjb2RlOiAnQkMtMTIzNDUnLFxuICAgICAgcHJpY2U6IDI1Ljk5LFxuICAgICAgZGVzY3JpcHRpb246ICdIaWdoLXF1YWxpdHkgYmlrZSBjaGFpbicsXG4gICAgICBjcmVhdGVkQXQ6ICcyMDIzLTAxLTAxVDAwOjAwOjAwWidcbiAgICB9XSxcbiAgICBjb21tZW50czogWydXYWl0aW5nIGZvciBTY2h3YWxiZSBNYXJhdGhvbiB0aXJlcyB0byBhcnJpdmUnXVxuICB9LFxuICB7XG4gICAgaWQ6ICc0JyxcbiAgICBjdXN0b21lcklkOiAnMScsXG4gICAgY3VzdG9tZXI6IHtcbiAgICAgIGlkOiAnMScsXG4gICAgICBuYW1lOiAnSm9obiBTbWl0aCcsXG4gICAgICBlbWFpbDogJ2pvaG5AZXhhbXBsZS5jb20nLFxuICAgICAgcGhvbmU6ICcxMjMtNDU2LTc4OTAnLFxuICAgICAgbWFya2V0aW5nQ29uc2VudDogdHJ1ZSxcbiAgICAgIGNyZWF0ZWRBdDogJzIwMjMtMDEtMTVUMTA6MDA6MDBaJ1xuICAgIH0sXG4gICAgZXF1aXBtZW50QnJhbmQ6ICdDYW5ub25kYWxlJyxcbiAgICBzZXJ2aWNlVHlwZTogJ0Z1bGwgU2VydmljZScsXG4gICAgcmVjaXBpZW50OiAnU2VsZicsXG4gICAgYWRkaXRpb25hbERldGFpbHM6ICdBbm51YWwgbWFpbnRlbmFuY2UnLFxuICAgIHN0YXR1czogJ2RvbmUnLFxuICAgIGNyZWF0ZWRBdDogJzIwMjMtMDQtMTVUMDk6MDA6MDBaJyxcbiAgICB1cGRhdGVkQXQ6ICcyMDIzLTA0LTE4VDE2OjMwOjAwWicsXG4gICAgY29tcGxldGlvbkRhdGU6ICcyMDIzLTA0LTE4VDE2OjMwOjAwWicsXG4gICAgdG90YWxDb3N0OiAxMjAuNTAsXG4gICAgbWVjaGFuaWNJZDogJ00yJyxcbiAgICBwYXJ0c1VzZWQ6IFt7XG4gICAgICBpZDogJzEnLFxuICAgICAgbmFtZTogJ0Jpa2UgQ2hhaW4nLFxuICAgICAgY2F0ZWdvcnk6ICdQYXJ0cycsXG4gICAgICBiYXJjb2RlOiAnQkMtMTIzNDUnLFxuICAgICAgcHJpY2U6IDI1Ljk5LFxuICAgICAgZGVzY3JpcHRpb246ICdIaWdoLXF1YWxpdHkgYmlrZSBjaGFpbicsXG4gICAgICBjcmVhdGVkQXQ6ICcyMDIzLTAxLTAxVDAwOjAwOjAwWidcbiAgICB9XSxcbiAgICBjb21tZW50czogWydDb21wbGV0ZSBzZXJ2aWNlIHBlcmZvcm1lZCcsICdOZXcgY2hhaW4gaW5zdGFsbGVkJywgJ0FsbCBiZWFyaW5ncyBjbGVhbmVkIGFuZCByZWdyZWFzZWQnLCAnUmVhZHkgZm9yIHBpY2t1cCddXG4gIH0sXG4gIHtcbiAgICBpZDogJzUnLFxuICAgIGN1c3RvbWVySWQ6ICcyJyxcbiAgICBjdXN0b21lcjoge1xuICAgICAgaWQ6ICcyJyxcbiAgICAgIG5hbWU6ICdKYW5lIERvZScsXG4gICAgICBlbWFpbDogJ2phbmVAZXhhbXBsZS5jb20nLFxuICAgICAgcGhvbmU6ICcyMzQtNTY3LTg5MDEnLFxuICAgICAgbWFya2V0aW5nQ29uc2VudDogZmFsc2UsXG4gICAgICBjcmVhdGVkQXQ6ICcyMDIzLTAyLTEwVDE0OjMwOjAwWidcbiAgICB9LFxuICAgIGVxdWlwbWVudEJyYW5kOiAnQ2VydmVsbycsXG4gICAgc2VydmljZVR5cGU6ICdTaW1wbGUgU2VydmljZScsXG4gICAgcmVjaXBpZW50OiAnU2VsZicsXG4gICAgYWRkaXRpb25hbERldGFpbHM6ICdEZXJhaWxsZXVyIGFkanVzdG1lbnQnLFxuICAgIHN0YXR1czogJ3RvZG8nLFxuICAgIGNyZWF0ZWRBdDogJzIwMjMtMDUtMDZUMTM6MTU6MDBaJyxcbiAgICB1cGRhdGVkQXQ6ICcyMDIzLTA1LTA2VDEzOjE1OjAwWicsXG4gICAgY29tbWVudHM6IFtdXG4gIH1cbl07XG5cbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBHRVQocmVxdWVzdDogTmV4dFJlcXVlc3QpIHtcbiAgdHJ5IHtcbiAgICBjb25zdCBzZWFyY2hQYXJhbXMgPSByZXF1ZXN0Lm5leHRVcmwuc2VhcmNoUGFyYW1zO1xuICAgIGNvbnN0IHN0YXR1cyA9IHNlYXJjaFBhcmFtcy5nZXQoJ3N0YXR1cycpO1xuXG4gICAgLy8gRW5zdXJlIHRoZSBkYXRhYmFzZSBzY2hlbWEgZXhpc3RzXG4gICAgYXdhaXQgZW5zdXJlRGF0YWJhc2VTY2hlbWEoKTtcblxuICAgIC8vIFRyeSB0byBmZXRjaCBmcm9tIFN1cGFiYXNlXG4gICAgdHJ5IHtcbiAgICAgIGNvbnNvbGUubG9nKCdBdHRlbXB0aW5nIHRvIGZldGNoIGRhdGEgZnJvbSBTdXBhYmFzZS4uLicpO1xuICAgICAgY29uc3QgcXVlcnkgPSBzdXBhYmFzZVxuICAgICAgICAuZnJvbSgnc2VydmljZV90aWNrZXRzJylcbiAgICAgICAgLnNlbGVjdChgXG4gICAgICAgICAgKixcbiAgICAgICAgICBzZXJ2aWNlX3JlcXVlc3Q6c2VydmljZV9yZXF1ZXN0X2lkKCosXG4gICAgICAgICAgICBjdXN0b21lcjpjdXN0b21lcl9pZCgqKVxuICAgICAgICAgIClcbiAgICAgICAgYCk7XG5cbiAgICAgIGlmIChzdGF0dXMpIHtcbiAgICAgICAgcXVlcnkuZXEoJ3N0YXR1cycsIHN0YXR1cyk7XG4gICAgICB9XG5cbiAgICAgIGNvbnN0IHsgZGF0YSwgZXJyb3IgfSA9IGF3YWl0IHF1ZXJ5Lm9yZGVyKCdjcmVhdGVkX2F0JywgeyBhc2NlbmRpbmc6IGZhbHNlIH0pO1xuXG4gICAgICBpZiAoZXJyb3IpIHtcbiAgICAgICAgY29uc29sZS5lcnJvcignU3VwYWJhc2UgcXVlcnkgZXJyb3I6JywgZXJyb3IpO1xuICAgICAgfVxuXG4gICAgICBjb25zb2xlLmxvZygnUmF3IGRhdGEgcmVjZWl2ZWQ6JywgZGF0YSA/IGAke2RhdGEubGVuZ3RofSB0aWNrZXRzYCA6ICdObyBkYXRhJyk7XG4gICAgICBpZiAoZGF0YSAmJiBkYXRhLmxlbmd0aCA+IDApIHtcbiAgICAgICAgY29uc29sZS5sb2coJ0ZpcnN0IHRpY2tldCByYXcgZGF0YTonLCBKU09OLnN0cmluZ2lmeShkYXRhWzBdLCBudWxsLCAyKSk7XG4gICAgICB9XG5cbiAgICAgIGlmICghZXJyb3IgJiYgZGF0YSAmJiBkYXRhLmxlbmd0aCA+IDApIHtcbiAgICAgICAgLy8gVHJhbnNmb3JtIHRoZSBkYXRhIHRvIG1hdGNoIG91ciBmcm9udGVuZCB0eXBlc1xuICAgICAgICBjb25zdCB0cmFuc2Zvcm1lZERhdGEgPSBkYXRhLm1hcCgodGlja2V0OiBhbnkpID0+IHtcbiAgICAgICAgICAvLyBFeHRyYWN0IGN1c3RvbWVyIGRhdGEgb3IgY3JlYXRlIGZhbGxiYWNrc1xuICAgICAgICAgIGxldCBjdXN0b21lckRhdGEgPSB7XG4gICAgICAgICAgICBpZDogJ3Vua25vd24nLFxuICAgICAgICAgICAgbmFtZTogJ1Vua25vd24gQ3VzdG9tZXInLFxuICAgICAgICAgICAgZW1haWw6ICduby1lbWFpbEBleGFtcGxlLmNvbScsXG4gICAgICAgICAgICBwaG9uZTogJ05vIHBob25lIG51bWJlcicsXG4gICAgICAgICAgICBtYXJrZXRpbmdDb25zZW50OiBmYWxzZSxcbiAgICAgICAgICAgIGNyZWF0ZWRBdDogdGlja2V0LmNyZWF0ZWRfYXRcbiAgICAgICAgICB9O1xuXG4gICAgICAgICAgLy8gVHJ5IHRvIGdldCBjdXN0b21lciBmcm9tIHRoZSBuZXN0ZWQgb2JqZWN0XG4gICAgICAgICAgaWYgKHRpY2tldC5zZXJ2aWNlX3JlcXVlc3Q/LmN1c3RvbWVyKSB7XG4gICAgICAgICAgICBjdXN0b21lckRhdGEgPSB7XG4gICAgICAgICAgICAgIGlkOiB0aWNrZXQuc2VydmljZV9yZXF1ZXN0LmN1c3RvbWVyLmlkIHx8IGN1c3RvbWVyRGF0YS5pZCxcbiAgICAgICAgICAgICAgbmFtZTogdGlja2V0LnNlcnZpY2VfcmVxdWVzdC5jdXN0b21lci5uYW1lIHx8IGN1c3RvbWVyRGF0YS5uYW1lLFxuICAgICAgICAgICAgICBlbWFpbDogdGlja2V0LnNlcnZpY2VfcmVxdWVzdC5jdXN0b21lci5lbWFpbCB8fCBjdXN0b21lckRhdGEuZW1haWwsXG4gICAgICAgICAgICAgIHBob25lOiB0aWNrZXQuc2VydmljZV9yZXF1ZXN0LmN1c3RvbWVyLnBob25lIHx8IGN1c3RvbWVyRGF0YS5waG9uZSxcbiAgICAgICAgICAgICAgbWFya2V0aW5nQ29uc2VudDogdGlja2V0LnNlcnZpY2VfcmVxdWVzdC5jdXN0b21lci5tYXJrZXRpbmdfY29uc2VudCB8fCBjdXN0b21lckRhdGEubWFya2V0aW5nQ29uc2VudCxcbiAgICAgICAgICAgICAgY3JlYXRlZEF0OiB0aWNrZXQuc2VydmljZV9yZXF1ZXN0LmN1c3RvbWVyLmNyZWF0ZWRfYXQgfHwgY3VzdG9tZXJEYXRhLmNyZWF0ZWRBdFxuICAgICAgICAgICAgfTtcbiAgICAgICAgICB9XG5cbiAgICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgaWQ6IHRpY2tldC5pZCxcbiAgICAgICAgICAgIGN1c3RvbWVySWQ6IHRpY2tldC5zZXJ2aWNlX3JlcXVlc3Q/LmN1c3RvbWVyX2lkIHx8ICd1bmtub3duJyxcbiAgICAgICAgICAgIGVxdWlwbWVudEJyYW5kOiB0aWNrZXQuc2VydmljZV9yZXF1ZXN0Py5lcXVpcG1lbnRfYnJhbmQgfHwgJ1Vua25vd24nLFxuICAgICAgICAgICAgc2VydmljZVR5cGU6IHRpY2tldC5zZXJ2aWNlX3JlcXVlc3Q/LnNlcnZpY2VfdHlwZSB8fCAnT3RoZXInLFxuICAgICAgICAgICAgcmVjaXBpZW50OiB0aWNrZXQuc2VydmljZV9yZXF1ZXN0Py5yZWNpcGllbnQgfHwgJ1NlbGYnLFxuICAgICAgICAgICAgYWRkaXRpb25hbERldGFpbHM6IHRpY2tldC5zZXJ2aWNlX3JlcXVlc3Q/LmFkZGl0aW9uYWxfZGV0YWlscyB8fCAnJyxcbiAgICAgICAgICAgIHN0YXR1czogdGlja2V0LnN0YXR1cyxcbiAgICAgICAgICAgIGNyZWF0ZWRBdDogdGlja2V0LmNyZWF0ZWRfYXQsXG4gICAgICAgICAgICB1cGRhdGVkQXQ6IHRpY2tldC51cGRhdGVkX2F0LFxuICAgICAgICAgICAgY3VzdG9tZXI6IGN1c3RvbWVyRGF0YSxcbiAgICAgICAgICAgIHBhcnRzVXNlZDogdGlja2V0LnBhcnRzX3VzZWQgfHwgW10sXG4gICAgICAgICAgICBtZWNoYW5pY0lkOiB0aWNrZXQubWVjaGFuaWNfaWQsXG4gICAgICAgICAgICBjb21wbGV0aW9uRGF0ZTogdGlja2V0LmNvbXBsZXRpb25fZGF0ZSxcbiAgICAgICAgICAgIHRvdGFsQ29zdDogdGlja2V0LnRvdGFsX2Nvc3QsXG4gICAgICAgICAgICBjb21tZW50czogdGlja2V0LmNvbW1lbnRzIHx8IFtdXG4gICAgICAgICAgfTtcbiAgICAgICAgfSk7XG5cbiAgICAgICAgY29uc29sZS5sb2coJ1RyYW5zZm9ybWVkIGZpcnN0IHRpY2tldDonLCBKU09OLnN0cmluZ2lmeSh0cmFuc2Zvcm1lZERhdGFbMF0sIG51bGwsIDIpKTtcbiAgICAgICAgcmV0dXJuIE5leHRSZXNwb25zZS5qc29uKHsgdGlja2V0czogdHJhbnNmb3JtZWREYXRhIH0pO1xuICAgICAgfVxuICAgIH0gY2F0Y2ggKGRiRXJyb3IpIHtcbiAgICAgIGNvbnNvbGUuZXJyb3IoJ0RhdGFiYXNlIGVycm9yLCBmYWxsaW5nIGJhY2sgdG8gbW9jayBkYXRhOicsIGRiRXJyb3IpO1xuICAgIH1cblxuICAgIC8vIElmIHdlIGdvdCBoZXJlLCBlaXRoZXIgdGhlcmUgd2FzIGEgZGF0YWJhc2UgZXJyb3Igb3Igbm8gcmVzdWx0cywgdXNlIG1vY2sgZGF0YVxuICAgIGNvbnN0IGZpbHRlcmVkVGlja2V0cyA9IHN0YXR1c1xuICAgICAgPyBtb2NrU2VydmljZVRpY2tldHMuZmlsdGVyKHRpY2tldCA9PiB0aWNrZXQuc3RhdHVzID09PSBzdGF0dXMpXG4gICAgICA6IG1vY2tTZXJ2aWNlVGlja2V0cztcbiAgICBcbiAgICByZXR1cm4gTmV4dFJlc3BvbnNlLmpzb24oeyB0aWNrZXRzOiBmaWx0ZXJlZFRpY2tldHMgfSk7XG4gICAgXG4gIH0gY2F0Y2ggKGVycm9yOiBhbnkpIHtcbiAgICBjb25zb2xlLmVycm9yKCdFcnJvciBpbiBzZXJ2aWNlLXRpY2tldHMgQVBJOicsIGVycm9yKTtcbiAgICByZXR1cm4gTmV4dFJlc3BvbnNlLmpzb24oXG4gICAgICB7IHRpY2tldHM6IG1vY2tTZXJ2aWNlVGlja2V0cyB9LFxuICAgICAgeyBzdGF0dXM6IDIwMCB9XG4gICAgKTtcbiAgfVxufVxuXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gUE9TVChyZXF1ZXN0OiBOZXh0UmVxdWVzdCkge1xuICB0cnkge1xuICAgIGNvbnN0IGJvZHkgPSBhd2FpdCByZXF1ZXN0Lmpzb24oKTtcbiAgICBjb25zdCB7IHNlcnZpY2VSZXF1ZXN0LCBjdXN0b21lciB9ID0gYm9keTtcblxuICAgIC8vIEZpcnN0IGNoZWNrIGlmIGN1c3RvbWVyIGV4aXN0c1xuICAgIGxldCBjdXN0b21lcklkID0gbnVsbDtcbiAgICBjb25zdCB7IGRhdGE6IGV4aXN0aW5nQ3VzdG9tZXIgfSA9IGF3YWl0IHN1cGFiYXNlXG4gICAgICAuZnJvbSgnY3VzdG9tZXJzJylcbiAgICAgIC5zZWxlY3QoJ2lkJylcbiAgICAgIC5lcSgnZW1haWwnLCBjdXN0b21lci5lbWFpbClcbiAgICAgIC5zaW5nbGUoKTtcblxuICAgIGlmIChleGlzdGluZ0N1c3RvbWVyKSB7XG4gICAgICBjdXN0b21lcklkID0gZXhpc3RpbmdDdXN0b21lci5pZDtcblxuICAgICAgLy8gVXBkYXRlIGN1c3RvbWVyIGlmIGl0IGV4aXN0c1xuICAgICAgYXdhaXQgc3VwYWJhc2VcbiAgICAgICAgLmZyb20oJ2N1c3RvbWVycycpXG4gICAgICAgIC51cGRhdGUoe1xuICAgICAgICAgIG5hbWU6IGN1c3RvbWVyLm5hbWUsXG4gICAgICAgICAgcGhvbmU6IGN1c3RvbWVyLnBob25lLFxuICAgICAgICAgIG1hcmtldGluZ19jb25zZW50OiBjdXN0b21lci5tYXJrZXRpbmdDb25zZW50XG4gICAgICAgIH0pXG4gICAgICAgIC5lcSgnaWQnLCBjdXN0b21lcklkKTtcbiAgICB9IGVsc2Uge1xuICAgICAgLy8gQ3JlYXRlIG5ldyBjdXN0b21lclxuICAgICAgY29uc3QgeyBkYXRhOiBuZXdDdXN0b21lciwgZXJyb3I6IGN1c3RvbWVyRXJyb3IgfSA9IGF3YWl0IHN1cGFiYXNlXG4gICAgICAgIC5mcm9tKCdjdXN0b21lcnMnKVxuICAgICAgICAuaW5zZXJ0KHtcbiAgICAgICAgICBuYW1lOiBjdXN0b21lci5uYW1lLFxuICAgICAgICAgIGVtYWlsOiBjdXN0b21lci5lbWFpbCxcbiAgICAgICAgICBwaG9uZTogY3VzdG9tZXIucGhvbmUsXG4gICAgICAgICAgbWFya2V0aW5nX2NvbnNlbnQ6IGN1c3RvbWVyLm1hcmtldGluZ0NvbnNlbnRcbiAgICAgICAgfSlcbiAgICAgICAgLnNlbGVjdCgpXG4gICAgICAgIC5zaW5nbGUoKTtcblxuICAgICAgaWYgKGN1c3RvbWVyRXJyb3IpIHtcbiAgICAgICAgcmV0dXJuIE5leHRSZXNwb25zZS5qc29uKFxuICAgICAgICAgIHsgZXJyb3I6ICdFcnJvciBjcmVhdGluZyBjdXN0b21lcicsIGRldGFpbHM6IGN1c3RvbWVyRXJyb3IubWVzc2FnZSB9LFxuICAgICAgICAgIHsgc3RhdHVzOiA1MDAgfVxuICAgICAgICApO1xuICAgICAgfVxuXG4gICAgICBjdXN0b21lcklkID0gbmV3Q3VzdG9tZXIuaWQ7XG4gICAgfVxuXG4gICAgLy8gQ3JlYXRlIHNlcnZpY2UgcmVxdWVzdFxuICAgIGNvbnN0IHsgZGF0YTogc2VydmljZVJlcXVlc3REYXRhLCBlcnJvcjogc2VydmljZVJlcXVlc3RFcnJvciB9ID0gYXdhaXQgc3VwYWJhc2VcbiAgICAgIC5mcm9tKCdzZXJ2aWNlX3JlcXVlc3RzJylcbiAgICAgIC5pbnNlcnQoe1xuICAgICAgICBjdXN0b21lcl9pZDogY3VzdG9tZXJJZCxcbiAgICAgICAgZXF1aXBtZW50X2JyYW5kOiBzZXJ2aWNlUmVxdWVzdC5lcXVpcG1lbnRCcmFuZCxcbiAgICAgICAgc2VydmljZV90eXBlOiBzZXJ2aWNlUmVxdWVzdC5zZXJ2aWNlVHlwZSxcbiAgICAgICAgcmVjaXBpZW50OiBzZXJ2aWNlUmVxdWVzdC5yZWNpcGllbnQsXG4gICAgICAgIGFkZGl0aW9uYWxfZGV0YWlsczogc2VydmljZVJlcXVlc3QuYWRkaXRpb25hbERldGFpbHNcbiAgICAgIH0pXG4gICAgICAuc2VsZWN0KClcbiAgICAgIC5zaW5nbGUoKTtcblxuICAgIGlmIChzZXJ2aWNlUmVxdWVzdEVycm9yKSB7XG4gICAgICByZXR1cm4gTmV4dFJlc3BvbnNlLmpzb24oXG4gICAgICAgIHsgZXJyb3I6ICdFcnJvciBjcmVhdGluZyBzZXJ2aWNlIHJlcXVlc3QnLCBkZXRhaWxzOiBzZXJ2aWNlUmVxdWVzdEVycm9yLm1lc3NhZ2UgfSxcbiAgICAgICAgeyBzdGF0dXM6IDUwMCB9XG4gICAgICApO1xuICAgIH1cblxuICAgIC8vIENyZWF0ZSBzZXJ2aWNlIHRpY2tldFxuICAgIGNvbnN0IHsgZGF0YTogdGlja2V0RGF0YSwgZXJyb3I6IHRpY2tldEVycm9yIH0gPSBhd2FpdCBzdXBhYmFzZVxuICAgICAgLmZyb20oJ3NlcnZpY2VfdGlja2V0cycpXG4gICAgICAuaW5zZXJ0KHtcbiAgICAgICAgc2VydmljZV9yZXF1ZXN0X2lkOiBzZXJ2aWNlUmVxdWVzdERhdGEuaWQsXG4gICAgICAgIHN0YXR1czogJ3RvZG8nLFxuICAgICAgICBjb21tZW50czogW11cbiAgICAgIH0pXG4gICAgICAuc2VsZWN0KClcbiAgICAgIC5zaW5nbGUoKTtcblxuICAgIGlmICh0aWNrZXRFcnJvcikge1xuICAgICAgcmV0dXJuIE5leHRSZXNwb25zZS5qc29uKFxuICAgICAgICB7IGVycm9yOiAnRXJyb3IgY3JlYXRpbmcgc2VydmljZSB0aWNrZXQnLCBkZXRhaWxzOiB0aWNrZXRFcnJvci5tZXNzYWdlIH0sXG4gICAgICAgIHsgc3RhdHVzOiA1MDAgfVxuICAgICAgKTtcbiAgICB9XG5cbiAgICByZXR1cm4gTmV4dFJlc3BvbnNlLmpzb24oe1xuICAgICAgdGlja2V0OiB0aWNrZXREYXRhLFxuICAgICAgc2VydmljZVJlcXVlc3Q6IHNlcnZpY2VSZXF1ZXN0RGF0YSxcbiAgICAgIGN1c3RvbWVyOiB7XG4gICAgICAgIGlkOiBjdXN0b21lcklkLFxuICAgICAgICBuYW1lOiBjdXN0b21lci5uYW1lLFxuICAgICAgICBlbWFpbDogY3VzdG9tZXIuZW1haWwsXG4gICAgICAgIHBob25lOiBjdXN0b21lci5waG9uZSxcbiAgICAgICAgbWFya2V0aW5nQ29uc2VudDogY3VzdG9tZXIubWFya2V0aW5nQ29uc2VudFxuICAgICAgfVxuICAgIH0sIHsgc3RhdHVzOiAyMDEgfSk7XG4gIH0gY2F0Y2ggKGVycm9yOiBhbnkpIHtcbiAgICByZXR1cm4gTmV4dFJlc3BvbnNlLmpzb24oXG4gICAgICB7IGVycm9yOiAnSW50ZXJuYWwgU2VydmVyIEVycm9yJywgZGV0YWlsczogZXJyb3I/Lm1lc3NhZ2UgfSxcbiAgICAgIHsgc3RhdHVzOiA1MDAgfVxuICAgICk7XG4gIH1cbn1cblxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIFBBVENIKHJlcXVlc3Q6IE5leHRSZXF1ZXN0KSB7XG4gIHRyeSB7XG4gICAgY29uc3QgYm9keSA9IGF3YWl0IHJlcXVlc3QuanNvbigpO1xuICAgIGNvbnN0IHsgaWQsIHN0YXR1cywgcGFydHNVc2VkLCBtZWNoYW5pY0lkLCB0b3RhbENvc3QsIGNvbW1lbnRzIH0gPSBib2R5O1xuXG4gICAgaWYgKCFpZCkge1xuICAgICAgcmV0dXJuIE5leHRSZXNwb25zZS5qc29uKFxuICAgICAgICB7IGVycm9yOiAnVGlja2V0IElEIGlzIHJlcXVpcmVkJyB9LFxuICAgICAgICB7IHN0YXR1czogNDAwIH1cbiAgICAgICk7XG4gICAgfVxuXG4gICAgY29uc3QgdXBkYXRlczogYW55ID0ge307XG4gICAgXG4gICAgaWYgKHN0YXR1cykgdXBkYXRlcy5zdGF0dXMgPSBzdGF0dXM7XG4gICAgaWYgKHBhcnRzVXNlZCkgdXBkYXRlcy5wYXJ0c191c2VkID0gcGFydHNVc2VkO1xuICAgIGlmIChtZWNoYW5pY0lkKSB1cGRhdGVzLm1lY2hhbmljX2lkID0gbWVjaGFuaWNJZDtcbiAgICBpZiAodG90YWxDb3N0KSB1cGRhdGVzLnRvdGFsX2Nvc3QgPSB0b3RhbENvc3Q7XG4gICAgaWYgKGNvbW1lbnRzKSB1cGRhdGVzLmNvbW1lbnRzID0gY29tbWVudHM7XG4gICAgXG4gICAgLy8gSWYgc3RhdHVzIGlzICdkb25lJywgc2V0IGNvbXBsZXRpb24gZGF0ZVxuICAgIGlmIChzdGF0dXMgPT09ICdkb25lJykge1xuICAgICAgdXBkYXRlcy5jb21wbGV0aW9uX2RhdGUgPSBuZXcgRGF0ZSgpLnRvSVNPU3RyaW5nKCk7XG4gICAgfVxuXG4gICAgdHJ5IHtcbiAgICAgIC8vIFRyeSB0byB1cGRhdGUgaW4gU3VwYWJhc2VcbiAgICAgIGNvbnN0IHsgZGF0YSwgZXJyb3IgfSA9IGF3YWl0IHN1cGFiYXNlXG4gICAgICAgIC5mcm9tKCdzZXJ2aWNlX3RpY2tldHMnKVxuICAgICAgICAudXBkYXRlKHVwZGF0ZXMpXG4gICAgICAgIC5lcSgnaWQnLCBpZClcbiAgICAgICAgLnNlbGVjdCgpXG4gICAgICAgIC5zaW5nbGUoKTtcblxuICAgICAgaWYgKCFlcnJvcikge1xuICAgICAgICByZXR1cm4gTmV4dFJlc3BvbnNlLmpzb24oeyB0aWNrZXQ6IGRhdGEgfSk7XG4gICAgICB9XG4gICAgfSBjYXRjaCAoZGJFcnJvcikge1xuICAgICAgY29uc29sZS5lcnJvcignRGF0YWJhc2UgdXBkYXRlIGVycm9yLCB1c2luZyBjbGllbnQtc2lkZSBvbmx5OicsIGRiRXJyb3IpO1xuICAgIH1cblxuICAgIC8vIElmIGRhdGFiYXNlIHVwZGF0ZSBmYWlsZWQsIHVzZSBtb2NrIGRhdGEgZm9yIGRlbW9uc3RyYXRpb25cbiAgICBpZiAoY29tbWVudHMpIHtcbiAgICAgIC8vIEZpbmQgYW5kIHVwZGF0ZSB0aGUgdGlja2V0IGluIG91ciBtb2NrIGRhdGFcbiAgICAgIGNvbnN0IHRpY2tldEluZGV4ID0gbW9ja1NlcnZpY2VUaWNrZXRzLmZpbmRJbmRleCh0ID0+IHQuaWQgPT09IGlkKTtcbiAgICAgIGlmICh0aWNrZXRJbmRleCAhPT0gLTEpIHtcbiAgICAgICAgLy8gV2UndmUgdmVyaWZpZWQgdGhlIGluZGV4IGV4aXN0cywgc28gdGhlIHRpY2tldCBkZWZpbml0ZWx5IGV4aXN0cyBhdCB0aGlzIHBvaW50XG4gICAgICAgIGNvbnN0IHRpY2tldCA9IG1vY2tTZXJ2aWNlVGlja2V0c1t0aWNrZXRJbmRleF0gYXMgU2VydmljZVRpY2tldDtcbiAgICAgICAgXG4gICAgICAgIC8vIEluaXRpYWxpemUgY29tbWVudHMgaWYgbmVlZGVkXG4gICAgICAgIGlmICghdGlja2V0LmNvbW1lbnRzKSB7XG4gICAgICAgICAgdGlja2V0LmNvbW1lbnRzID0gW107XG4gICAgICAgIH1cbiAgICAgICAgXG4gICAgICAgIC8vIFVwZGF0ZSBjb21tZW50c1xuICAgICAgICB0aWNrZXQuY29tbWVudHMgPSBjb21tZW50cztcbiAgICAgICAgXG4gICAgICAgIHJldHVybiBOZXh0UmVzcG9uc2UuanNvbih7IFxuICAgICAgICAgIHN1Y2Nlc3M6IHRydWUsXG4gICAgICAgICAgdGlja2V0XG4gICAgICAgIH0pO1xuICAgICAgfVxuICAgIH1cblxuICAgIC8vIEdlbmVyaWMgc3VjY2VzcyByZXNwb25zZSBmb3Igb3RoZXIgdXBkYXRlc1xuICAgIHJldHVybiBOZXh0UmVzcG9uc2UuanNvbih7IFxuICAgICAgc3VjY2VzczogdHJ1ZSxcbiAgICAgIG1lc3NhZ2U6ICdTdGF0dXMgdXBkYXRlZCBpbiBVSSBvbmx5LiBEYXRhYmFzZSB1cGRhdGUgbm90IGF2YWlsYWJsZS4nXG4gICAgfSk7XG4gICAgXG4gIH0gY2F0Y2ggKGVycm9yOiBhbnkpIHtcbiAgICBjb25zb2xlLmVycm9yKCdFcnJvciBpbiBQQVRDSDonLCBlcnJvcik7XG4gICAgcmV0dXJuIE5leHRSZXNwb25zZS5qc29uKFxuICAgICAgeyBlcnJvcjogJ0ludGVybmFsIFNlcnZlciBFcnJvcicsIGRldGFpbHM6IGVycm9yPy5tZXNzYWdlIH0sXG4gICAgICB7IHN0YXR1czogNTAwIH1cbiAgICApO1xuICB9XG59ICJdLCJuYW1lcyI6WyJzdXBhYmFzZSIsImVuc3VyZURhdGFiYXNlU2NoZW1hIiwiTmV4dFJlc3BvbnNlIiwibW9ja1NlcnZpY2VUaWNrZXRzIiwiaWQiLCJjdXN0b21lcklkIiwiY3VzdG9tZXIiLCJuYW1lIiwiZW1haWwiLCJwaG9uZSIsIm1hcmtldGluZ0NvbnNlbnQiLCJjcmVhdGVkQXQiLCJlcXVpcG1lbnRCcmFuZCIsInNlcnZpY2VUeXBlIiwicmVjaXBpZW50IiwiYWRkaXRpb25hbERldGFpbHMiLCJzdGF0dXMiLCJ1cGRhdGVkQXQiLCJjb21tZW50cyIsIm1lY2hhbmljSWQiLCJwYXJ0c1VzZWQiLCJjYXRlZ29yeSIsImJhcmNvZGUiLCJwcmljZSIsImRlc2NyaXB0aW9uIiwiY29tcGxldGlvbkRhdGUiLCJ0b3RhbENvc3QiLCJHRVQiLCJyZXF1ZXN0Iiwic2VhcmNoUGFyYW1zIiwibmV4dFVybCIsImdldCIsImNvbnNvbGUiLCJsb2ciLCJxdWVyeSIsImZyb20iLCJzZWxlY3QiLCJlcSIsImRhdGEiLCJlcnJvciIsIm9yZGVyIiwiYXNjZW5kaW5nIiwibGVuZ3RoIiwiSlNPTiIsInN0cmluZ2lmeSIsInRyYW5zZm9ybWVkRGF0YSIsIm1hcCIsInRpY2tldCIsImN1c3RvbWVyRGF0YSIsImNyZWF0ZWRfYXQiLCJzZXJ2aWNlX3JlcXVlc3QiLCJtYXJrZXRpbmdfY29uc2VudCIsImN1c3RvbWVyX2lkIiwiZXF1aXBtZW50X2JyYW5kIiwic2VydmljZV90eXBlIiwiYWRkaXRpb25hbF9kZXRhaWxzIiwidXBkYXRlZF9hdCIsInBhcnRzX3VzZWQiLCJtZWNoYW5pY19pZCIsImNvbXBsZXRpb25fZGF0ZSIsInRvdGFsX2Nvc3QiLCJqc29uIiwidGlja2V0cyIsImRiRXJyb3IiLCJmaWx0ZXJlZFRpY2tldHMiLCJmaWx0ZXIiLCJQT1NUIiwiYm9keSIsInNlcnZpY2VSZXF1ZXN0IiwiZXhpc3RpbmdDdXN0b21lciIsInNpbmdsZSIsInVwZGF0ZSIsIm5ld0N1c3RvbWVyIiwiY3VzdG9tZXJFcnJvciIsImluc2VydCIsImRldGFpbHMiLCJtZXNzYWdlIiwic2VydmljZVJlcXVlc3REYXRhIiwic2VydmljZVJlcXVlc3RFcnJvciIsInRpY2tldERhdGEiLCJ0aWNrZXRFcnJvciIsInNlcnZpY2VfcmVxdWVzdF9pZCIsIlBBVENIIiwidXBkYXRlcyIsIkRhdGUiLCJ0b0lTT1N0cmluZyIsInRpY2tldEluZGV4IiwiZmluZEluZGV4IiwidCIsInN1Y2Nlc3MiXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(rsc)/./src/app/api/service-tickets/route.ts\n");

/***/ }),

/***/ "(rsc)/./src/lib/supabase.ts":
/*!*****************************!*\
  !*** ./src/lib/supabase.ts ***!
  \*****************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   ensureDatabaseSchema: () => (/* binding */ ensureDatabaseSchema),\n/* harmony export */   isSupabaseConfigured: () => (/* binding */ isSupabaseConfigured),\n/* harmony export */   supabase: () => (/* binding */ supabase)\n/* harmony export */ });\n/* harmony import */ var _supabase_supabase_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @supabase/supabase-js */ \"(rsc)/./node_modules/@supabase/supabase-js/dist/module/index.js\");\n\n// Use placeholders if environment variables are not set\nconst supabaseUrl = \"https://pawppmozqdizuhmnlrnn.supabase.co\" || 0;\nconst supabaseAnonKey = \"eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InBhd3BwbW96cWRpenVobW5scm5uIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NDIxNDUxNjMsImV4cCI6MjA1NzcyMTE2M30.T7U0bZv-cEtn-Ol35zo5p5_jAyIHLjLG8UOE0qOMIXg\" || 0;\n// The createClient function will create a Supabase client even with invalid credentials,\n// but API calls will fail, which we handle in our API routes with fallback data\nconst supabase = (0,_supabase_supabase_js__WEBPACK_IMPORTED_MODULE_0__.createClient)(supabaseUrl, supabaseAnonKey);\n// This function checks if we have valid credentials\nconst isSupabaseConfigured = ()=>{\n    return  true && \"https://pawppmozqdizuhmnlrnn.supabase.co\".includes(\"supabase.co\") && \"eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InBhd3BwbW96cWRpenVobW5scm5uIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NDIxNDUxNjMsImV4cCI6MjA1NzcyMTE2M30.T7U0bZv-cEtn-Ol35zo5p5_jAyIHLjLG8UOE0qOMIXg\" && \"eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InBhd3BwbW96cWRpenVobW5scm5uIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NDIxNDUxNjMsImV4cCI6MjA1NzcyMTE2M30.T7U0bZv-cEtn-Ol35zo5p5_jAyIHLjLG8UOE0qOMIXg\".length > 10;\n};\n// Function to verify and ensure the correct database schema\nconst ensureDatabaseSchema = async ()=>{\n    if (!isSupabaseConfigured()) {\n        console.log(\"Supabase not properly configured, skipping schema check\");\n        return false;\n    }\n    try {\n        console.log(\"Checking database schema...\");\n        // Check if tables exist\n        const { data: tables, error } = await supabase.from(\"information_schema.tables\").select(\"table_name\").eq(\"table_schema\", \"public\");\n        if (error) {\n            console.error(\"Error checking tables:\", error);\n            return false;\n        }\n        const tableNames = tables.map((t)=>t.table_name);\n        console.log(\"Existing tables:\", tableNames);\n        // Create customers table if it doesn't exist\n        if (!tableNames.includes(\"customers\")) {\n            console.log(\"Creating customers table...\");\n            const { error: createError } = await supabase.rpc(\"create_customers_table\");\n            if (createError) console.error(\"Error creating customers table:\", createError);\n        }\n        // Create service_requests table if it doesn't exist\n        if (!tableNames.includes(\"service_requests\")) {\n            console.log(\"Creating service_requests table...\");\n            const { error: createError } = await supabase.rpc(\"create_service_requests_table\");\n            if (createError) console.error(\"Error creating service_requests table:\", createError);\n        }\n        // Create service_tickets table if it doesn't exist\n        if (!tableNames.includes(\"service_tickets\")) {\n            console.log(\"Creating service_tickets table...\");\n            const { error: createError } = await supabase.rpc(\"create_service_tickets_table\");\n            if (createError) console.error(\"Error creating service_tickets table:\", createError);\n        }\n        // Check if comments column exists in service_tickets\n        if (tableNames.includes(\"service_tickets\")) {\n            const { data: columns, error: columnsError } = await supabase.from(\"information_schema.columns\").select(\"column_name\").eq(\"table_name\", \"service_tickets\").eq(\"table_schema\", \"public\");\n            if (columnsError) {\n                console.error(\"Error checking columns:\", columnsError);\n            } else {\n                const columnNames = columns.map((c)=>c.column_name);\n                console.log(\"service_tickets columns:\", columnNames);\n                // Add comments column if it doesn't exist\n                if (!columnNames.includes(\"comments\")) {\n                    console.log(\"Adding comments column to service_tickets table...\");\n                    // Run SQL to add the column\n                    const { error: alterError } = await supabase.rpc(\"add_comments_column_to_service_tickets\");\n                    if (alterError) {\n                        console.error(\"Error adding comments column:\", alterError);\n                        // Direct SQL approach as backup if RPC fails\n                        const { error: sqlError } = await supabase.from(\"service_tickets\").update({\n                            comments: []\n                        }).is(\"comments\", null).select().limit(0); // Dummy update to initialize the column\n                        if (sqlError) {\n                            console.error(\"Error with direct SQL to add comments column:\", sqlError);\n                        } else {\n                            console.log(\"Successfully added comments column via direct SQL\");\n                        }\n                    } else {\n                        console.log(\"Successfully added comments column via RPC\");\n                    }\n                }\n            }\n        }\n        return true;\n    } catch (error) {\n        console.error(\"Error ensuring database schema:\", error);\n        return false;\n    }\n};\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,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b0JBRVAsSUFBSU0sWUFBWTt3QkFDZG5CLFFBQVFJLEtBQUssQ0FBQyxpQ0FBaUNlO3dCQUUvQyw2Q0FBNkM7d0JBQzdDLE1BQU0sRUFBRWYsT0FBT2dCLFFBQVEsRUFBRSxHQUFHLE1BQU16QixTQUMvQlUsSUFBSSxDQUFDLG1CQUNMZ0IsTUFBTSxDQUFDOzRCQUFFQyxVQUFVLEVBQUU7d0JBQUMsR0FDdEJDLEVBQUUsQ0FBQyxZQUFZLE1BQ2ZqQixNQUFNLEdBQ05rQixLQUFLLENBQUMsSUFBSyx3Q0FBd0M7d0JBRXRELElBQUlKLFVBQVU7NEJBQ1pwQixRQUFRSSxLQUFLLENBQUMsaURBQWlEZ0I7d0JBQ2pFLE9BQU87NEJBQ0xwQixRQUFRQyxHQUFHLENBQUM7d0JBQ2Q7b0JBQ0YsT0FBTzt3QkFDTEQsUUFBUUMsR0FBRyxDQUFDO29CQUNkO2dCQUNGO1lBQ0Y7UUFDRjtRQUVBLE9BQU87SUFDVCxFQUFFLE9BQU9HLE9BQU87UUFDZEosUUFBUUksS0FBSyxDQUFDLG1DQUFtQ0E7UUFDakQsT0FBTztJQUNUO0FBQ0YsRUFBRSIsInNvdXJjZXMiOlsid2VicGFjazovL2Jpa2Utc2hvcC1zZXJ2aWNlLW1hbmFnZW1lbnQvLi9zcmMvbGliL3N1cGFiYXNlLnRzPzA2ZTEiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgY3JlYXRlQ2xpZW50IH0gZnJvbSAnQHN1cGFiYXNlL3N1cGFiYXNlLWpzJztcblxuLy8gVXNlIHBsYWNlaG9sZGVycyBpZiBlbnZpcm9ubWVudCB2YXJpYWJsZXMgYXJlIG5vdCBzZXRcbmNvbnN0IHN1cGFiYXNlVXJsID0gcHJvY2Vzcy5lbnYuTkVYVF9QVUJMSUNfU1VQQUJBU0VfVVJMIHx8ICdodHRwczovL3BsYWNlaG9sZGVyLXVybC1mb3ItZGV2ZWxvcG1lbnQuc3VwYWJhc2UuY28nO1xuY29uc3Qgc3VwYWJhc2VBbm9uS2V5ID0gcHJvY2Vzcy5lbnYuTkVYVF9QVUJMSUNfU1VQQUJBU0VfQU5PTl9LRVkgfHwgJ3BsYWNlaG9sZGVyLWFub24ta2V5LWZvci1kZXZlbG9wbWVudCc7XG5cbi8vIFRoZSBjcmVhdGVDbGllbnQgZnVuY3Rpb24gd2lsbCBjcmVhdGUgYSBTdXBhYmFzZSBjbGllbnQgZXZlbiB3aXRoIGludmFsaWQgY3JlZGVudGlhbHMsXG4vLyBidXQgQVBJIGNhbGxzIHdpbGwgZmFpbCwgd2hpY2ggd2UgaGFuZGxlIGluIG91ciBBUEkgcm91dGVzIHdpdGggZmFsbGJhY2sgZGF0YVxuZXhwb3J0IGNvbnN0IHN1cGFiYXNlID0gY3JlYXRlQ2xpZW50KHN1cGFiYXNlVXJsLCBzdXBhYmFzZUFub25LZXkpO1xuXG4vLyBUaGlzIGZ1bmN0aW9uIGNoZWNrcyBpZiB3ZSBoYXZlIHZhbGlkIGNyZWRlbnRpYWxzXG5leHBvcnQgY29uc3QgaXNTdXBhYmFzZUNvbmZpZ3VyZWQgPSAoKSA9PiB7XG4gIHJldHVybiAoXG4gICAgcHJvY2Vzcy5lbnYuTkVYVF9QVUJMSUNfU1VQQUJBU0VfVVJMICYmXG4gICAgcHJvY2Vzcy5lbnYuTkVYVF9QVUJMSUNfU1VQQUJBU0VfVVJMLmluY2x1ZGVzKCdzdXBhYmFzZS5jbycpICYmXG4gICAgcHJvY2Vzcy5lbnYuTkVYVF9QVUJMSUNfU1VQQUJBU0VfQU5PTl9LRVkgJiZcbiAgICBwcm9jZXNzLmVudi5ORVhUX1BVQkxJQ19TVVBBQkFTRV9BTk9OX0tFWS5sZW5ndGggPiAxMFxuICApO1xufTtcblxuLy8gRnVuY3Rpb24gdG8gdmVyaWZ5IGFuZCBlbnN1cmUgdGhlIGNvcnJlY3QgZGF0YWJhc2Ugc2NoZW1hXG5leHBvcnQgY29uc3QgZW5zdXJlRGF0YWJhc2VTY2hlbWEgPSBhc3luYyAoKSA9PiB7XG4gIGlmICghaXNTdXBhYmFzZUNvbmZpZ3VyZWQoKSkge1xuICAgIGNvbnNvbGUubG9nKCdTdXBhYmFzZSBub3QgcHJvcGVybHkgY29uZmlndXJlZCwgc2tpcHBpbmcgc2NoZW1hIGNoZWNrJyk7XG4gICAgcmV0dXJuIGZhbHNlO1xuICB9XG5cbiAgdHJ5IHtcbiAgICBjb25zb2xlLmxvZygnQ2hlY2tpbmcgZGF0YWJhc2Ugc2NoZW1hLi4uJyk7XG4gICAgXG4gICAgLy8gQ2hlY2sgaWYgdGFibGVzIGV4aXN0XG4gICAgY29uc3QgeyBkYXRhOiB0YWJsZXMsIGVycm9yIH0gPSBhd2FpdCBzdXBhYmFzZVxuICAgICAgLmZyb20oJ2luZm9ybWF0aW9uX3NjaGVtYS50YWJsZXMnKVxuICAgICAgLnNlbGVjdCgndGFibGVfbmFtZScpXG4gICAgICAuZXEoJ3RhYmxlX3NjaGVtYScsICdwdWJsaWMnKTtcbiAgICBcbiAgICBpZiAoZXJyb3IpIHtcbiAgICAgIGNvbnNvbGUuZXJyb3IoJ0Vycm9yIGNoZWNraW5nIHRhYmxlczonLCBlcnJvcik7XG4gICAgICByZXR1cm4gZmFsc2U7XG4gICAgfVxuICAgIFxuICAgIGNvbnN0IHRhYmxlTmFtZXMgPSB0YWJsZXMubWFwKCh0OiBhbnkpID0+IHQudGFibGVfbmFtZSk7XG4gICAgY29uc29sZS5sb2coJ0V4aXN0aW5nIHRhYmxlczonLCB0YWJsZU5hbWVzKTtcbiAgICBcbiAgICAvLyBDcmVhdGUgY3VzdG9tZXJzIHRhYmxlIGlmIGl0IGRvZXNuJ3QgZXhpc3RcbiAgICBpZiAoIXRhYmxlTmFtZXMuaW5jbHVkZXMoJ2N1c3RvbWVycycpKSB7XG4gICAgICBjb25zb2xlLmxvZygnQ3JlYXRpbmcgY3VzdG9tZXJzIHRhYmxlLi4uJyk7XG4gICAgICBjb25zdCB7IGVycm9yOiBjcmVhdGVFcnJvciB9ID0gYXdhaXQgc3VwYWJhc2UucnBjKCdjcmVhdGVfY3VzdG9tZXJzX3RhYmxlJyk7XG4gICAgICBpZiAoY3JlYXRlRXJyb3IpIGNvbnNvbGUuZXJyb3IoJ0Vycm9yIGNyZWF0aW5nIGN1c3RvbWVycyB0YWJsZTonLCBjcmVhdGVFcnJvcik7XG4gICAgfVxuICAgIFxuICAgIC8vIENyZWF0ZSBzZXJ2aWNlX3JlcXVlc3RzIHRhYmxlIGlmIGl0IGRvZXNuJ3QgZXhpc3RcbiAgICBpZiAoIXRhYmxlTmFtZXMuaW5jbHVkZXMoJ3NlcnZpY2VfcmVxdWVzdHMnKSkge1xuICAgICAgY29uc29sZS5sb2coJ0NyZWF0aW5nIHNlcnZpY2VfcmVxdWVzdHMgdGFibGUuLi4nKTtcbiAgICAgIGNvbnN0IHsgZXJyb3I6IGNyZWF0ZUVycm9yIH0gPSBhd2FpdCBzdXBhYmFzZS5ycGMoJ2NyZWF0ZV9zZXJ2aWNlX3JlcXVlc3RzX3RhYmxlJyk7XG4gICAgICBpZiAoY3JlYXRlRXJyb3IpIGNvbnNvbGUuZXJyb3IoJ0Vycm9yIGNyZWF0aW5nIHNlcnZpY2VfcmVxdWVzdHMgdGFibGU6JywgY3JlYXRlRXJyb3IpO1xuICAgIH1cbiAgICBcbiAgICAvLyBDcmVhdGUgc2VydmljZV90aWNrZXRzIHRhYmxlIGlmIGl0IGRvZXNuJ3QgZXhpc3RcbiAgICBpZiAoIXRhYmxlTmFtZXMuaW5jbHVkZXMoJ3NlcnZpY2VfdGlja2V0cycpKSB7XG4gICAgICBjb25zb2xlLmxvZygnQ3JlYXRpbmcgc2VydmljZV90aWNrZXRzIHRhYmxlLi4uJyk7XG4gICAgICBjb25zdCB7IGVycm9yOiBjcmVhdGVFcnJvciB9ID0gYXdhaXQgc3VwYWJhc2UucnBjKCdjcmVhdGVfc2VydmljZV90aWNrZXRzX3RhYmxlJyk7XG4gICAgICBpZiAoY3JlYXRlRXJyb3IpIGNvbnNvbGUuZXJyb3IoJ0Vycm9yIGNyZWF0aW5nIHNlcnZpY2VfdGlja2V0cyB0YWJsZTonLCBjcmVhdGVFcnJvcik7XG4gICAgfVxuXG4gICAgLy8gQ2hlY2sgaWYgY29tbWVudHMgY29sdW1uIGV4aXN0cyBpbiBzZXJ2aWNlX3RpY2tldHNcbiAgICBpZiAodGFibGVOYW1lcy5pbmNsdWRlcygnc2VydmljZV90aWNrZXRzJykpIHtcbiAgICAgIGNvbnN0IHsgZGF0YTogY29sdW1ucywgZXJyb3I6IGNvbHVtbnNFcnJvciB9ID0gYXdhaXQgc3VwYWJhc2VcbiAgICAgICAgLmZyb20oJ2luZm9ybWF0aW9uX3NjaGVtYS5jb2x1bW5zJylcbiAgICAgICAgLnNlbGVjdCgnY29sdW1uX25hbWUnKVxuICAgICAgICAuZXEoJ3RhYmxlX25hbWUnLCAnc2VydmljZV90aWNrZXRzJylcbiAgICAgICAgLmVxKCd0YWJsZV9zY2hlbWEnLCAncHVibGljJyk7XG4gICAgICBcbiAgICAgIGlmIChjb2x1bW5zRXJyb3IpIHtcbiAgICAgICAgY29uc29sZS5lcnJvcignRXJyb3IgY2hlY2tpbmcgY29sdW1uczonLCBjb2x1bW5zRXJyb3IpO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgY29uc3QgY29sdW1uTmFtZXMgPSBjb2x1bW5zLm1hcCgoYzogYW55KSA9PiBjLmNvbHVtbl9uYW1lKTtcbiAgICAgICAgY29uc29sZS5sb2coJ3NlcnZpY2VfdGlja2V0cyBjb2x1bW5zOicsIGNvbHVtbk5hbWVzKTtcbiAgICAgICAgXG4gICAgICAgIC8vIEFkZCBjb21tZW50cyBjb2x1bW4gaWYgaXQgZG9lc24ndCBleGlzdFxuICAgICAgICBpZiAoIWNvbHVtbk5hbWVzLmluY2x1ZGVzKCdjb21tZW50cycpKSB7XG4gICAgICAgICAgY29uc29sZS5sb2coJ0FkZGluZyBjb21tZW50cyBjb2x1bW4gdG8gc2VydmljZV90aWNrZXRzIHRhYmxlLi4uJyk7XG4gICAgICAgICAgXG4gICAgICAgICAgLy8gUnVuIFNRTCB0byBhZGQgdGhlIGNvbHVtblxuICAgICAgICAgIGNvbnN0IHsgZXJyb3I6IGFsdGVyRXJyb3IgfSA9IGF3YWl0IHN1cGFiYXNlXG4gICAgICAgICAgICAucnBjKCdhZGRfY29tbWVudHNfY29sdW1uX3RvX3NlcnZpY2VfdGlja2V0cycpO1xuICAgICAgICAgIFxuICAgICAgICAgIGlmIChhbHRlckVycm9yKSB7XG4gICAgICAgICAgICBjb25zb2xlLmVycm9yKCdFcnJvciBhZGRpbmcgY29tbWVudHMgY29sdW1uOicsIGFsdGVyRXJyb3IpO1xuICAgICAgICAgICAgXG4gICAgICAgICAgICAvLyBEaXJlY3QgU1FMIGFwcHJvYWNoIGFzIGJhY2t1cCBpZiBSUEMgZmFpbHNcbiAgICAgICAgICAgIGNvbnN0IHsgZXJyb3I6IHNxbEVycm9yIH0gPSBhd2FpdCBzdXBhYmFzZVxuICAgICAgICAgICAgICAuZnJvbSgnc2VydmljZV90aWNrZXRzJylcbiAgICAgICAgICAgICAgLnVwZGF0ZSh7IGNvbW1lbnRzOiBbXSB9KVxuICAgICAgICAgICAgICAuaXMoJ2NvbW1lbnRzJywgbnVsbClcbiAgICAgICAgICAgICAgLnNlbGVjdCgpXG4gICAgICAgICAgICAgIC5saW1pdCgwKTsgIC8vIER1bW15IHVwZGF0ZSB0byBpbml0aWFsaXplIHRoZSBjb2x1bW5cbiAgICAgICAgICAgIFxuICAgICAgICAgICAgaWYgKHNxbEVycm9yKSB7XG4gICAgICAgICAgICAgIGNvbnNvbGUuZXJyb3IoJ0Vycm9yIHdpdGggZGlyZWN0IFNRTCB0byBhZGQgY29tbWVudHMgY29sdW1uOicsIHNxbEVycm9yKTtcbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgIGNvbnNvbGUubG9nKCdTdWNjZXNzZnVsbHkgYWRkZWQgY29tbWVudHMgY29sdW1uIHZpYSBkaXJlY3QgU1FMJyk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIGNvbnNvbGUubG9nKCdTdWNjZXNzZnVsbHkgYWRkZWQgY29tbWVudHMgY29sdW1uIHZpYSBSUEMnKTtcbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9XG4gICAgXG4gICAgcmV0dXJuIHRydWU7XG4gIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgY29uc29sZS5lcnJvcignRXJyb3IgZW5zdXJpbmcgZGF0YWJhc2Ugc2NoZW1hOicsIGVycm9yKTtcbiAgICByZXR1cm4gZmFsc2U7XG4gIH1cbn07ICJdLCJuYW1lcyI6WyJjcmVhdGVDbGllbnQiLCJzdXBhYmFzZVVybCIsInByb2Nlc3MiLCJlbnYiLCJORVhUX1BVQkxJQ19TVVBBQkFTRV9VUkwiLCJzdXBhYmFzZUFub25LZXkiLCJORVhUX1BVQkxJQ19TVVBBQkFTRV9BTk9OX0tFWSIsInN1cGFiYXNlIiwiaXNTdXBhYmFzZUNvbmZpZ3VyZWQiLCJpbmNsdWRlcyIsImxlbmd0aCIsImVuc3VyZURhdGFiYXNlU2NoZW1hIiwiY29uc29sZSIsImxvZyIsImRhdGEiLCJ0YWJsZXMiLCJlcnJvciIsImZyb20iLCJzZWxlY3QiLCJlcSIsInRhYmxlTmFtZXMiLCJtYXAiLCJ0IiwidGFibGVfbmFtZSIsImNyZWF0ZUVycm9yIiwicnBjIiwiY29sdW1ucyIsImNvbHVtbnNFcnJvciIsImNvbHVtbk5hbWVzIiwiYyIsImNvbHVtbl9uYW1lIiwiYWx0ZXJFcnJvciIsInNxbEVycm9yIiwidXBkYXRlIiwiY29tbWVudHMiLCJpcyIsImxpbWl0Il0sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(rsc)/./src/lib/supabase.ts\n");

/***/ })

};
;

// load runtime
var __webpack_require__ = require("../../../webpack-runtime.js");
__webpack_require__.C(exports);
var __webpack_exec__ = (moduleId) => (__webpack_require__(__webpack_require__.s = moduleId))
var __webpack_exports__ = __webpack_require__.X(0, ["vendor-chunks/next","vendor-chunks/@supabase","vendor-chunks/tr46","vendor-chunks/whatwg-url","vendor-chunks/webidl-conversions"], () => (__webpack_exec__("(rsc)/./node_modules/next/dist/build/webpack/loaders/next-app-loader.js?name=app%2Fapi%2Fservice-tickets%2Froute&page=%2Fapi%2Fservice-tickets%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Fservice-tickets%2Froute.ts&appDir=%2FUsers%2Faigarsild%2Fcycle-track%2Fsrc%2Fapp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=%2FUsers%2Faigarsild%2Fcycle-track&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=&preferredRegion=&middlewareConfig=e30%3D!")));
module.exports = __webpack_exports__;

})();